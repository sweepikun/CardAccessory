

---

### ğŸ§  **Promptï¼šCardAccessorySystem æ’ä»¶ â€”â€” ä¸‹ä¸€æ­¥å¼€å‘æŒ‡ä»¤ï¼ˆPhase: å®Œå–„æ ¸å¿ƒé€»è¾‘ï¼‰**

```prompt
ä½ æ˜¯ä¸€ä½ç²¾é€š Spigot æ’ä»¶å¼€å‘ä¸ Minecraft ç”Ÿæ€é›†æˆçš„é«˜çº§å·¥ç¨‹å¸ˆã€‚  
æˆ‘æ­£åœ¨å¼€å‘ `CardAccessorySystem` æ’ä»¶ï¼ˆåŒ…åï¼š`cn.popcraft.cardaccessory`ï¼‰ï¼Œç›®å‰å·²å®ŒæˆåŸºç¡€æ¡†æ¶ã€é…ç½®åŠ è½½ã€ItemsAdder å…¼å®¹ã€GUI ç•Œé¢å’Œå‘½ä»¤ç³»ç»Ÿã€‚

ä½†ä»¥ä¸‹å…³é”®åŠŸèƒ½ä»éœ€å®Œå–„ï¼Œè¯·**ä¼˜å…ˆå®ç°ä»¥ä¸‹ä¸‰é¡¹æ ¸å¿ƒä»»åŠ¡**ï¼Œè¾“å‡º**å¯ç›´æ¥é›†æˆåˆ°ç°æœ‰é¡¹ç›®**çš„ä»£ç ï¼š

---

## ğŸ¯ ä»»åŠ¡ 1ï¼šå®ç° NBT æ ‡ç­¾ç³»ç»Ÿï¼ˆä½¿ç”¨ PersistentDataContainerï¼‰

### èƒŒæ™¯
å½“å‰é€šè¿‡ç‰©å“ç±»å‹åˆ¤æ–­å¡ç‰Œ/é¥°å“ï¼Œææ˜“è¯¯åˆ¤ã€‚éœ€æ”¹ç”¨ **PersistentDataContainer (PDC)** è¿›è¡Œç²¾ç¡®æ ‡è¯†ã€‚

### è¦æ±‚
- å®šä¹‰ä¸¤ä¸ªå‘½åç©ºé—´é”®ï¼ˆNamespacedKeyï¼‰ï¼š
  - å¡ç‰Œï¼š`cas:card_id` â†’ å€¼ä¸ºå¡ç‰Œ IDï¼ˆå¦‚ `"fire_heart"`ï¼‰
  - é¥°å“ï¼š`cas:accessory_id` â†’ å€¼ä¸ºé¥°å“ IDï¼ˆå¦‚ `"thunder_amulet"`ï¼‰
- åœ¨ `ItemManager` ç”Ÿæˆç‰©å“æ—¶ï¼Œè‡ªåŠ¨å†™å…¥å¯¹åº” PDC æ ‡ç­¾
- åœ¨ `EquipListener` å’Œ GUI ä¸­ï¼Œ**ä»…é€šè¿‡ PDC åˆ¤æ–­**ç‰©å“æ˜¯å¦ä¸ºæœ‰æ•ˆå¡ç‰Œ/é¥°å“
- å¸ä¸‹/æ›¿æ¢æ—¶ï¼Œç¡®ä¿æ—§ç‰©å“çš„ PDC ä¸å½±å“æ–°é€»è¾‘

### äº¤ä»˜ç‰©
- å·¥å…·ç±»ï¼š`NBTKeys.java`ï¼ˆé›†ä¸­ç®¡ç† NamespacedKeyï¼‰
- ä¿®æ”¹ `ItemManager.java`ï¼šç”Ÿæˆç‰©å“æ—¶å†™å…¥ PDC
- ä¿®æ”¹æ‰€æœ‰è¯†åˆ«é€»è¾‘ï¼ˆç›‘å¬å™¨ã€GUIï¼‰ï¼šä½¿ç”¨ `item.getItemMeta().getPersistentDataContainer().has(KEY)` åˆ¤æ–­

---

## ğŸ¯ ä»»åŠ¡ 2ï¼šå®Œå–„ AttributePlus å±æ€§é›†æˆï¼ˆçœŸå® API è°ƒç”¨ï¼‰

### èƒŒæ™¯
å½“å‰å±æ€§åº”ç”¨ä»…ä¸ºå ä½ç¬¦ã€‚éœ€æ ¹æ® **AttributePlus å®é™… API** å®ç°å±æ€§åŠ¨æ€å¢å‡ã€‚

### è¦æ±‚
- åˆ›å»º `AttributePlusHook.java`ï¼ˆä½äº `hook` åŒ…ï¼‰
- å®‰å…¨æ£€æµ‹ AttributePlus æ˜¯å¦å¯ç”¨ï¼ˆ`Bukkit.getPluginManager().isPluginEnabled("AttributePlus")`ï¼‰
- å®ç°æ–¹æ³•ï¼š
  ```java
  public static void applyAttribute(Player player, String attributeName, double value)
  public static void removeAttribute(Player player, String attributeName, double value)
  ```
- å±æ€§åéœ€ä¸ `cards.yml` ä¸­çš„ `attributes` é”®ä¸€è‡´ï¼ˆå¦‚ `"MAX_HEALTH"`ï¼‰
- æ”¯æŒ**å åŠ **ï¼šåŒä¸€å±æ€§å¤šå¼ å¡ç‰Œå¯ç´¯åŠ ï¼ˆå¦‚ä¸¤å¼  +10 HP å¡ = +20 HPï¼‰
- ç©å®¶é€€å‡ºæ—¶**è‡ªåŠ¨ç§»é™¤æ‰€æœ‰ä¸´æ—¶å±æ€§**

> ğŸ’¡ è‹¥ AttributePlus æ— å…¬å¼€ APIï¼Œè¯·ä½¿ç”¨åå°„æˆ–ç›‘å¬å…¶äº‹ä»¶ï¼›è‹¥å®Œå…¨ä¸å¯ç”¨ï¼Œåˆ™å›é€€åˆ° Bukkit Attributeï¼ˆå¦‚ `GENERIC_MAX_HEALTH`ï¼‰

### äº¤ä»˜ç‰©
- `hook/AttributePlusHook.java`
- ä¿®æ”¹ `EffectManager.java`ï¼šè°ƒç”¨ä¸Šè¿°æ–¹æ³•åº”ç”¨/ç§»é™¤å±æ€§
- åœ¨ `EquipManager` è£…å¤‡/å¸ä¸‹æ—¶è§¦å‘å±æ€§å˜æ›´

---

## ğŸ¯ ä»»åŠ¡ 3ï¼šå®ç° GUI å®Œæ•´äº¤äº’ï¼ˆè£…å¤‡/å¸ä¸‹/æ§½ä½ç®¡ç†ï¼‰

### èƒŒæ™¯
å½“å‰ GUI ä»…ä¸ºé™æ€å±•ç¤ºï¼Œéœ€å®ç°å®Œæ•´äº¤äº’é€»è¾‘ã€‚

### è¦æ±‚
- **å¡ç‰Œ GUIï¼ˆ6Ã—9ï¼‰**ï¼š
  - æ§½ä½ 0-3ï¼šå½“å‰è£…å¤‡çš„ 4 å¼ å¡ç‰Œï¼ˆå¯ç‚¹å‡»å¸ä¸‹ï¼‰
  - å…¶ä½™æ ¼å­ï¼šèƒŒåŒ…ä¸­å¯è£…å¤‡çš„å¡ç‰Œï¼ˆç‚¹å‡»è£…å¤‡åˆ°ç¬¬ä¸€ä¸ªç©ºæ§½ï¼‰
- **é¥°å“ GUIï¼ˆ6Ã—9ï¼‰**ï¼š
  - æ§½ä½ 0-1ï¼šå½“å‰è£…å¤‡çš„ 2 ä¸ªé¥°å“
  - å…¶ä½™æ ¼å­ï¼šå¯è£…å¤‡é¥°å“
- **äº¤äº’è§„åˆ™**ï¼š
  - ç‚¹å‡»å·²è£…å¤‡å¡ç‰Œ â†’ å¸ä¸‹å¹¶è¿”è¿˜ç‰©å“åˆ°èƒŒåŒ…
  - ç‚¹å‡»æœªè£…å¤‡å¡ç‰Œ â†’ è£…å¤‡åˆ°ç¬¬ä¸€ä¸ªç©ºæ§½ï¼ˆè‹¥æ»¡åˆ™æç¤ºï¼‰
  - è‡ªåŠ¨åˆ·æ–° GUIï¼ˆè£…å¤‡åç«‹å³æ›´æ–°ç•Œé¢ï¼‰
  - é˜²æ­¢é‡å¤ç‚¹å‡»ï¼ˆå–æ¶ˆ InventoryClickEventï¼‰

### äº¤ä»˜ç‰©
- ä¿®æ”¹ `gui/CardGUI.java` å’Œ `gui/AccessoryGUI.java`
- å®ç° `onItemClick` é€»è¾‘ï¼ˆåŒºåˆ†â€œè£…å¤‡åŒºâ€å’Œâ€œèƒŒåŒ…åŒºâ€ï¼‰
- è°ƒç”¨ `EquipManager.equipCard()` / `unequipCard()` ç­‰æ–¹æ³•
- æ·»åŠ æç¤ºæ¶ˆæ¯ï¼ˆå¦‚â€œ&cå¡ç‰Œæ§½å·²æ»¡ï¼â€ï¼‰

---

## ğŸ“Œ é€šç”¨è¦æ±‚

- **åŒ…ç»“æ„**ï¼šä¸¥æ ¼éµå¾ª `cn.popcraft.cardaccessory.{manager,model,util,...}`
- **é”™è¯¯å¤„ç†**ï¼š
  - æ‰€æœ‰å¤–éƒ¨ API è°ƒç”¨éœ€ try-catch
  - æ’ä»¶æœªå®‰è£…æ—¶é™é»˜è·³è¿‡ï¼Œä¸æŠ¥é”™
- **æ€§èƒ½**ï¼š
  - GUI ç‚¹å‡»äº‹ä»¶ä¸­é¿å…é˜»å¡æ“ä½œ
  - å±æ€§å˜æ›´ä½¿ç”¨å¼‚æ­¥ä¿å­˜ï¼ˆä½†å±æ€§åº”ç”¨æœ¬èº«éœ€åŒæ­¥ï¼‰
- **ä»£ç é£æ ¼**ï¼š
  - å…³é”®é€»è¾‘æ·»åŠ ä¸­æ–‡æ³¨é‡Š
  - ä½¿ç”¨ `final`ã€`private` ç­‰ä¿®é¥°ç¬¦
  - é¿å…é­”æ³•å€¼ï¼ˆå¦‚æ§½ä½ç´¢å¼•å®šä¹‰ä¸ºå¸¸é‡ï¼‰

---

## â–¶ï¸ è¾“å‡ºæŒ‡ä»¤

è¯·æŒ‰é¡ºåºè¾“å‡ºä»¥ä¸‹å†…å®¹ï¼š
1. `util/NBTKeys.java`
2. ä¿®æ”¹åçš„ `ItemManager.java`ï¼ˆä»…å±•ç¤º PDC ç›¸å…³éƒ¨åˆ†ï¼Œæˆ–å®Œæ•´ç±»ï¼‰
3. `hook/AttributePlusHook.java`
4. ä¿®æ”¹åçš„ `EffectManager.java`ï¼ˆå±æ€§åº”ç”¨é€»è¾‘ï¼‰
5. å®Œæ•´çš„ `gui/CardGUI.java` å’Œ `gui/AccessoryGUI.java`ï¼ˆå«äº¤äº’é€»è¾‘ï¼‰

> æ³¨æ„ï¼šå‡è®¾ AttributePlus çš„å±æ€§è®¾ç½® API ä¸º `AttributePlusAPI.setAttribute(Player, String, double)`ï¼Œè‹¥å®é™…ä¸åŒï¼Œè¯·ä½¿ç”¨é€šç”¨åå°„æ–¹æ¡ˆå¹¶æ·»åŠ  TODO æ³¨é‡Šã€‚
```

